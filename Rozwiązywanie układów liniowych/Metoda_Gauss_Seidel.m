clc;
clear all;
%-------------------------
% Dane
%-------------------------
A=[8 1 2;...
   5 -3 -7;...
   0 -5 7];
B=[16;...
  -22;...
   11];
x0=[0;...
    0;...
    0];
x1=[0;...
    0;...
    0];

%-------------------------
% A=L+D+U
%-------------------------
L=A;
[W,K]=size(A);
for i=1:1:W
   L(i,i)=0;
end
L(1,3)=0;
L(2,3)=0;
L(1,2)=0;
D=zeros(3);
for i=1:1:W
    D(i,i)=A(i,i);
end

U=A;
for i=1:1:W
   U(i,i)=0;
end
U(3,1)=0;
U(2,1)=0;
U(3,2)=0;
%-------------------------
% D^-1
%-------------------------
D1=D;
Wyznacznik=(D(1,1)*D(2,2)*D(3,3)+D(1,2)*D(2,3)*D(3,1)+D(1,3)*D(2,1)*D(3,2))-(D(1,3)*D(2,2)*D(3,1)+D(1,1)*D(2,3)*D(3,2)+D(1,2)*D(2,1)*D(3,3));
for i=1:1:3
    for j=1:1:3
    Dop=D1;
    Dop(:,i)=[];
    Dop(j,:)=[];
    D(j,i)=(-1)^(j+i)*(Dop(1,1)*Dop(2,2)-Dop(2,1)*Dop(1,2));
    end
end

temp=D(1,2);
D(1,2)=D(2,1);
D(2,1)=temp;

temp=D(1,3);
D(1,3)=D(3,1);
D(3,1)=temp;

temp=D(3,2);
D(3,2)=D(2,3);
D(2,3)=temp;

D=D/Wyznacznik;

%-------------------------
% D^-1*B, D^-1*L, D^-1*U
%-------------------------

Z1=D*B;
Z2=D*L;
Z3=D*U;

%-------------------------
% Iteracje
%-------------------------


 for i=1:1:100
 x1(1,1)=Z1(1,1)-Z3(1,2)*x0(2,1)-Z3(1,3)*x0(3,1);
 x1(2,1)=Z1(2,1)-Z2(2,1)*x1(1,1)-Z3(2,3)*x0(3,1);
 x1(3,1)=Z1(3,1)-Z2(3,1)*x1(1,1)-Z2(3,2)*x1(2,1);
 epsilon=x1-x0;
 x0=x1;
    if ((epsilon(1,1)<0.0001 && epsilon(1,1)>-0.0001)) && (epsilon(2,1)<0.0001 && epsilon(2,1)>-0.0001) && (epsilon(3,1)<0.0001 && epsilon(3,1)>-0.0001)
         break;
    end
 end

